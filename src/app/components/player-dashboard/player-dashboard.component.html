<style>
  /* ===== VARIABLES Y RESET ===== */
  .dashboard-container {
    max-width: 1280px;
    margin: 0 auto;
    padding: 1.5rem;
  }

  .min-h-screen {
    min-height: 100vh;
  }

  /* ===== COMPONENTES PRINCIPALES ===== */
  .cards-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
  }

  @media (min-width: 768px) {
    .cards-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (min-width: 1024px) {
    .cards-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  .dashboard-card {
    background: white;
    padding: 1.5rem;
    border-radius: 0.75rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    transition: all 0.2s;
    cursor: pointer;
    text-align: left;
    border: none;
    min-height: 140px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .dashboard-card:hover {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
  }

  .next-match-card {
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
    min-height: 140px;
  }

  /* ===== CALENDARIO ===== */
  .calendar-header {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    color: white;
    padding: 1rem 1.5rem;
    margin: -1.5rem -1.5rem 1rem -1.5rem;
  }

  .calendar-month {
    font-size: 1rem;
    font-weight: 600;
    text-align: center;
    margin: 0;
  }

  .calendar-close-btn {
    background: #ef4444;
    color: white;
    width: 2rem;
    height: 2rem;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    cursor: pointer;
    font-size: 1.25rem;
    transition: all 0.2s;
  }

  .calendar-close-btn:hover {
    background: #dc2626;
    transform: scale(1.1);
  }

  .month-nav-btn {
    width: 2rem;
    height: 2rem;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #d1d5db;
    background: white;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 1rem;
  }

  .month-nav-btn:hover {
    background: #f3f4f6;
    border-color: #9ca3af;
  }

  .calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 0.15rem;
    margin-bottom: 1rem;
  }

  .week-day {
    font-size: 0.7rem;
    font-weight: 600;
    color: #4b5563;
    text-align: center;
    padding: 0.4rem 0;
    text-transform: uppercase;
    background: #f8fafc;
    border-radius: 0.25rem;
    margin: 0.1rem;
  }

  .calendar-day {
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0.375rem;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
    font-size: 0.75rem;
    font-weight: 500;
    margin: 0 auto;
  }

  .calendar-day:hover {
    background: #3b82f6;
    color: white;
    transform: scale(1.05);
  }

  .calendar-day.today {
    background: #ef4444;
    color: white;
    font-weight: 600;
    box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
  }

  .calendar-day.selected {
    background: #10b981;
    color: white;
    font-weight: 600;
    box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
  }

  .calendar-day.other-month {
    color: #9ca3af;
    background: #f9fafb;
  }

  .calendar-day.other-month:hover {
    background: #e5e7eb;
    color: #6b7280;
  }

  .calendar-day.has-events {
    background: #f8fafc;
    font-weight: 600;
    position: relative;
  }

  .calendar-day.has-events:hover {
    background: #3b82f6;
    color: white;
  }

  .calendar-day.has-events.today {
    background: #ef4444;
    color: white;
  }

  .calendar-day.has-events.selected {
    background: #10b981;
    color: white;
  }

  /* ===== PUNTOS DE EVENTOS EN CALENDARIO ===== */
  .event-dot {
    position: absolute;
    bottom: 2px;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 6px;
    border-radius: 50%;
    z-index: 10;
    box-shadow: 0 0 0 2px white;
  }

  .event-dot-training {
    background: #10b981;
  }

  .event-dot-tournament {
    background: #8b5cf6;
  }

  .event-dot-mixed {
    background: linear-gradient(135deg, #10b981 50%, #8b5cf6 50%);
  }

  /* ===== EVENTOS EN LISTA ===== */
  .event-item {
    padding: 0.75rem;
    border-radius: 0.5rem;
    margin-bottom: 0.5rem;
    border-left: 4px solid;
    transition: all 0.2s;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    position: relative;
  }

  .event-item:hover {
    transform: translateX(2px);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
  }

  .event-training {
    background: #f0fdf4;
    border-left-color: #10b981;
    color: #065f46;
  }

  .event-tournament {
    background: #f3e8ff;
    border-left-color: #8b5cf6;
    color: #6b21a8;
  }

  .event-meeting {
    background: #fffbeb;
    border-left-color: #f59e0b;
    color: #92400e;
  }

  .event-match {
    background: #fef2f2;
    border-left-color: #ef4444;
    color: #991b1b;
  }

  /* ===== BOTONES FLOTANTES ===== */
  .floating-btn {
    width: 3rem;
    height: 3rem;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.125rem;
    z-index: 40;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
    position: fixed;
    transition: all 0.3s ease;
  }

  .floating-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  }

  .calendar-btn {
    background: #3b82f6;
    color: white;
    left: 1.5rem;
    top: 1.5rem;
  }

  .calendar-btn:hover {
    background: #2563eb;
  }

  .chat-btn {
    background: #10b981;
    color: white;
    right: 1.5rem;
    bottom: 1.5rem;
  }

  .chat-btn:hover {
    background: #059669;
  }

  .calendar-sidebar.open ~ .floating-btn.calendar-btn {
    display: none;
  }

  .chat-sidebar.open ~ .floating-btn.chat-btn {
    display: none;
  }

  /* ===== GR√ÅFICAS Y ESTAD√çSTICAS ===== */
  .bars-container {
    display: flex;
    align-items: end;
    justify-content: space-between;
    height: 160px;
    padding: 1rem 0;
    gap: 1rem;
  }

  .bar-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    height: 100%;
  }

  .bar-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: end;
    height: 100%;
    width: 100%;
    position: relative;
  }

  .bar {
    width: 60%;
    min-height: 20px;
    border-radius: 8px 8px 0 0;
    transition: all 0.8s ease-in-out;
    display: flex;
    align-items: end;
    justify-content: center;
    position: relative;
  }

  .bar-resistance {
    background: linear-gradient(to top, #10b981, #34d399);
  }

  .bar-technique {
    background: linear-gradient(to top, #3b82f6, #60a5fa);
  }

  .bar-attitude {
    background: linear-gradient(to top, #f59e0b, #fbbf24);
  }

  .bar-value {
    color: white;
    font-weight: bold;
    font-size: 0.75rem;
    margin-bottom: 0.25rem;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  }

  .bar-label {
    margin-top: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    text-align: center;
  }

  .bar-icon {
    font-size: 1.5rem;
    margin-top: 0.25rem;
  }

  /* ===== SIDEBARS ===== */
  .sidebar {
    width: 24rem;
    height: 100vh;
    background: white;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    z-index: 50;
    position: fixed;
    top: 0;
    transition: transform 0.3s ease-in-out;
    overflow-y: auto;
  }

  .calendar-sidebar {
    left: 0;
    transform: translateX(-100%);
  }

  .calendar-sidebar.open {
    transform: translateX(0);
  }

  .chat-sidebar {
    right: 0;
    transform: translateX(100%);
  }

  .chat-sidebar.open {
    transform: translateX(0);
  }

  /* ===== ANIMACIONES ===== */
  .animate-fade-in {
    animation: fadeIn 0.3s ease-in;
  }

  .fade-in {
    animation: fadeIn 0.3s ease-in;
  }

  @keyframes fadeIn {
    from { 
      opacity: 0; 
      transform: translateY(10px); 
    }
    to { 
      opacity: 1; 
      transform: translateY(0); 
    }
  }

  /* ===== UTILIDADES ===== */
  .bg-gradient-to-br {
    background-image: linear-gradient(to bottom right, var(--tw-gradient-stops));
  }

  .from-blue-900 {
    --tw-gradient-from: #1e3a8a;
    --tw-gradient-to: rgb(30 58 138 / 0);
    --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);
  }

  .via-blue-800 {
    --tw-gradient-to: rgb(30 64 175 / 0);
    --tw-gradient-stops: var(--tw-gradient-from), #1e40af, var(--tw-gradient-to);
  }

  .to-indigo-900 {
    --tw-gradient-to: #312e81;
  }
</style>
<!-- ==== FIN DEL CSS ORGANIZADO ==== -->

<!-- Dashboard Jugador -->
<div class="min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900">

  <!-- Navigation -->
  <nav class="bg-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center space-x-3">
          <div class="bg-blue-600 w-10 h-10 rounded-full flex items-center justify-center">
            <span class="text-white font-bold">‚öΩ</span>
          </div>
          <h1 class="text-xl font-bold text-gray-800">Panel de Jugador</h1>
        </div>
        <div class="flex items-center space-x-4">
          <span class="text-gray-700">Bienvenido, {{ currentUser?.firstName }}</span>
          <button (click)="logout()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition duration-200">
            Salir
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto p-6">
    <!-- Quick Actions Grid -->
    <div class="cards-grid">
      <button (click)="showPlayerProfile()" class="dashboard-card">
        <div class="text-3xl mb-3">üë§</div>
        <h3 class="text-lg font-semibold text-gray-800">Mi Perfil</h3>
        <p class="text-gray-600">Ver y editar informaci√≥n personal</p>
      </button>

      <button (click)="showTrainings()" class="dashboard-card">
        <div class="text-3xl mb-3">üìÖ</div>
        <h3 class="text-lg font-semibold text-gray-800">Entrenamientos</h3>
        <p class="text-gray-600">Ver entrenamientos programados</p>
      </button>

      <button (click)="showPlayerStats()" class="dashboard-card">
        <div class="text-3xl mb-3">üìä</div>
        <h3 class="text-lg font-semibold text-gray-800">Estad√≠sticas</h3>
        <p class="text-gray-600">Ver mi rendimiento</p>
      </button>

      <div class="dashboard-card next-match-card">
        <div class="text-3xl mb-3">üèÜ</div>
        <h3 class="text-lg font-semibold">Pr√≥ximo Evento</h3>
        <p class="text-blue-100 text-sm mt-1">{{ playerStats.nextEvent }}</p>
        <p class="text-blue-200 text-xs">{{ playerStats.nextEventDate }}</p>
      </div>
    </div>

    <!-- Dynamic Content Area -->
    <div class="bg-white rounded-xl shadow-lg p-6 min-h-[400px]">
      
      <!-- Welcome View -->
      <div *ngIf="currentView === 'welcome'" class="fade-in">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Bienvenido, {{ currentUser?.firstName }}</h2>
        <p class="text-gray-600 mb-6">Selecciona una opci√≥n del men√∫ para comenzar.</p>
        
        <!-- Informaci√≥n del sistema -->
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 max-w-md">
          <h3 class="text-lg font-semibold text-green-800 mb-2">‚úÖ Sistema Conectado</h3>
          <p class="text-green-600">Tus entrenamientos y torneos se cargan autom√°ticamente desde el calendario del entrenador.</p>
        </div>
      </div>

      <!-- Profile View -->
      <div *ngIf="currentView === 'profile'" class="fade-in">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Mi Perfil</h2>
        
        <div *ngIf="loading" class="text-center py-8">
          <p class="text-gray-600">Cargando perfil...</p>
        </div>

        <div *ngIf="!loading && userProfile" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Columna Izquierda -->
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Nombre</label>
              <input type="text" [(ngModel)]="userProfile.firstName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Apellido</label>
              <input type="text" [(ngModel)]="userProfile.lastName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
              <input type="email" [(ngModel)]="userProfile.email" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Usuario</label>
              <input type="text" [(ngModel)]="userProfile.username" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
          </div>

          <!-- Columna Derecha -->
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Edad</label>
              <input type="number" [(ngModel)]="userProfile.age" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Tel√©fono</label>
              <input type="tel" [(ngModel)]="userProfile.phone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">Posici√≥n</label>
              <select [(ngModel)]="userProfile.position" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                <option value="PORTERO">Portero</option>
                <option value="DEFENSA">Defensa</option>
                <option value="MEDIOCAMPO">Mediocampo</option>
                <option value="DELANTERO">Delantero</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">N√∫mero de Camiseta</label>
              <input type="number" [(ngModel)]="userProfile.jerseyNumber" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
            </div>
          </div>
        </div>

        <div class="mt-6">
          <button (click)="updateProfile()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200">
            Guardar Cambios
          </button>
        </div>
      </div>

      <!-- Trainings View -->
      <div *ngIf="currentView === 'trainings'" class="fade-in">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Entrenamientos Programados</h2>
        
        <div *ngIf="trainings.length === 0" class="text-center py-12">
          <div class="text-6xl mb-4">üìÖ</div>
          <h3 class="text-xl font-semibold text-gray-700 mb-2">No hay entrenamientos programados</h3>
          <p class="text-gray-500 max-w-md mx-auto">
            Los entrenamientos aparecer√°n aqu√≠ cuando el entrenador los programe para el equipo.
          </p>
        </div>

        <div *ngIf="trainings.length > 0" class="space-y-4">
          <div *ngFor="let training of trainings" 
               class="border-l-4 p-4 rounded-lg"
               [class]="training.bgClass + ' ' + training.borderClass">
            <div class="flex justify-between items-start">
              <div class="flex-1">
                <h3 class="font-semibold text-gray-800 text-lg mb-1">{{ training.title }}</h3>
                <p class="text-gray-600 mb-1">{{ training.dateFormatted }}</p>
                <p class="text-sm text-gray-500">Entrenador: {{ training.coach }}</p>
                <p class="text-sm text-gray-500">Tipo: {{ training.type }}</p>
              </div>
              <span [class]="training.statusClass + ' text-white px-3 py-1 rounded-full text-sm font-medium'">
                {{ training.status }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Stats View -->
      <div *ngIf="currentView === 'stats'" class="fade-in">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Mis Estad√≠sticas</h2>
        
        <!-- Stats principales -->
        <div class="grid grid-cols-3 gap-4 mb-6">
          <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-4 rounded-xl text-white text-center">
            <div class="text-3xl mb-3">üìä</div>
            <h3 class="text-lg font-semibold">Mi Progreso</h3>
            <p class="text-blue-100 text-sm mt-1">Evaluaci√≥n continua</p>
          </div>

          <div class="bg-gradient-to-r from-green-500 to-green-600 p-4 rounded-xl text-white text-center">
            <div class="text-3xl mb-3">‚≠ê</div>
            <h3 class="text-lg font-semibold">Desempe√±o</h3>
            <p class="text-green-100 text-sm mt-1">{{ getOverallPerformance() }}% General</p>
          </div>

          <div class="bg-gradient-to-r from-purple-500 to-purple-600 p-4 rounded-xl text-white text-center">
            <div class="text-3xl mb-3">üèÜ</div>
            <h3 class="text-lg font-semibold">Pr√≥ximo Evento</h3>
            <p class="text-purple-100 text-sm mt-1">{{ playerStats.nextEvent }}</p>
            <p class="text-purple-200 text-xs">{{ playerStats.nextEventDate }}</p>
          </div>
        </div>

        <!-- Gr√°fica de Rendimiento Principal -->
        <div class="bg-white border border-gray-200 rounded-xl p-6 mb-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-6">üìà Mi Progreso de Rendimiento</h3>
          
          <div *ngIf="playerPerformance" class="space-y-8">
            <!-- Gr√°fica de barras horizontal mejorada -->
            <div class="space-y-6">
              <!-- Resistencia -->
              <div>
                <div class="flex justify-between items-center mb-2">
                  <div class="flex items-center space-x-2">
                    <span class="text-lg">üí™</span>
                    <span class="text-md font-medium text-gray-700">Resistencia</span>
                  </div>
                  <span class="text-lg font-bold text-green-600">{{ getEndurancePercentage() }}%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-6">
                  <div class="bg-gradient-to-r from-green-400 to-green-600 h-6 rounded-full transition-all duration-1000 flex items-center justify-end pr-2"
                       [style.width.%]="getEndurancePercentage()">
                    <span class="text-white text-xs font-bold"></span>
                  </div>
                </div>
              </div>

              <!-- T√©cnica -->
              <div>
                <div class="flex justify-between items-center mb-2">
                  <div class="flex items-center space-x-2">
                    <span class="text-lg">‚öΩ</span>
                    <span class="text-md font-medium text-gray-700">T√©cnica</span>
                  </div>
                  <span class="text-lg font-bold text-blue-600">{{ getTechniquePercentage() }}%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-6">
                  <div class="bg-gradient-to-r from-blue-400 to-blue-600 h-6 rounded-full transition-all duration-1000 flex items-center justify-end pr-2"
                       [style.width.%]="getTechniquePercentage()">
                    <span class="text-white text-xs font-bold"></span>
                  </div>
                </div>
              </div>

              <!-- Actitud -->
              <div>
                <div class="flex justify-between items-center mb-2">
                  <div class="flex items-center space-x-2">
                    <span class="text-lg">üòä</span>
                    <span class="text-md font-medium text-gray-700">Actitud</span>
                  </div>
                  <span class="text-lg font-bold text-yellow-600">{{ getAttitudePercentage() }}%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-6">
                  <div class="bg-gradient-to-r from-yellow-400 to-yellow-600 h-6 rounded-full transition-all duration-1000 flex items-center justify-end pr-2"
                       [style.width.%]="getAttitudePercentage()">
                    <span class="text-white text-xs font-bold"></span>
                  </div>
                </div>
              </div>
            </div>

            <!-- M√©tricas adicionales en grid -->
            <div class="grid grid-cols-3 gap-4 pt-4 border-t">
              <div class="text-center">
                <div class="text-2xl font-bold text-gray-800">{{ getTotalTrainings() }}</div>
                <div class="text-sm text-gray-600">Sesiones</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-gray-800">{{ getCurrentMonthTrainings() }}</div>
                <div class="text-sm text-gray-600">Este Mes</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-gray-800">{{ getConsistency() }}</div>
                <div class="text-sm text-gray-600">Consistencia</div>
              </div>
            </div>
          </div>

          <div *ngIf="!playerPerformance" class="text-center py-12">
            <div class="text-6xl mb-4">üìä</div>
            <p class="text-gray-500 text-lg mb-2">A√∫n no hay datos de rendimiento</p>
            <p class="text-sm text-gray-400">Los datos aparecer√°n despu√©s de que el entrenador eval√∫e tus entrenamientos</p>
          </div>
        </div>

        <!-- Gr√°fica de Barras Adicional -->
        <div class="bg-white border border-gray-200 rounded-xl p-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-6">üìä Resumen de M√©tricas</h3>
          
          <div *ngIf="playerPerformance" class="space-y-6">
            <!-- Gr√°fica de barras vertical -->
            <div class="bars-container">
              <!-- Resistencia -->
              <div class="bar-item">
                <div class="bar-wrapper">
                  <div class="bar bar-resistance" [style.height.%]="getEndurancePercentage()">
                    <span class="bar-value">{{ getEndurancePercentage() }}%</span>
                  </div>
                </div>
                <div class="bar-label">Resistencia</div>
                <div class="bar-icon">üí™</div>
              </div>

              <!-- T√©cnica -->
              <div class="bar-item">
                <div class="bar-wrapper">
                  <div class="bar bar-technique" [style.height.%]="getTechniquePercentage()">
                    <span class="bar-value">{{ getTechniquePercentage() }}%</span>
                  </div>
                </div>
                <div class="bar-label">T√©cnica</div>
                <div class="bar-icon">‚öΩ</div>
              </div>

              <!-- Actitud -->
              <div class="bar-item">
                <div class="bar-wrapper">
                  <div class="bar bar-attitude" [style.height.%]="getAttitudePercentage()">
                    <span class="bar-value">{{ getAttitudePercentage() }}%</span>
                  </div>
                </div>
                <div class="bar-label">Actitud</div>
                <div class="bar-icon">üòä</div>
              </div>
            </div>

            <!-- Leyenda -->
            <div class="grid grid-cols-3 gap-4 text-center pt-4 border-t">
              <div>
                <div class="text-sm font-semibold text-green-600">{{ getEndurancePercentage() }}%</div>
                <div class="text-xs text-gray-500">Resistencia</div>
              </div>
              <div>
                <div class="text-sm font-semibold text-blue-600">{{ getTechniquePercentage() }}%</div>
                <div class="text-xs text-gray-500">T√©cnica</div>
              </div>
              <div>
                <div class="text-sm font-semibold text-yellow-600">{{ getAttitudePercentage() }}%</div>
                <div class="text-xs text-gray-500">Actitud</div>
              </div>
            </div>
          </div>

          <div *ngIf="!playerPerformance" class="text-center py-8">
            <div class="text-4xl mb-2">üìà</div>
            <p class="text-gray-500">Esperando datos de evaluaci√≥n</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Floating Action Buttons -->
  <button (click)="toggleCalendar()" class="floating-btn calendar-btn">
    üìÖ
  </button>

  <button (click)="toggleChat()" class="floating-btn chat-btn">
    üí¨
  </button>
</div>

<!-- Calendar Sidebar - ACTUALIZADO -->
<div [class]="'sidebar calendar-sidebar ' + (calendarVisible ? 'open' : '')">
  <div class="p-0">
    <div class="calendar-header pt-8 pb-2"> 
      <div class="flex justify-between items-center mb-3">
        <div class="flex-1 text-center">
          <h2 class="text-lg font-bold">üìÖ Calendario</h2>
        </div>
        <button (click)="toggleCalendar()" class="calendar-close-btn bg-red-500 hover:bg-red-600">
          √ó
        </button>
      </div>
      <div class="flex justify-between items-center">
        <button (click)="previousMonth()" class="month-nav-btn text-black bg-white bg-opacity-20 hover:bg-opacity-30">
          ‚Äπ
        </button>
        <h3 class="calendar-month">{{ currentMonth }}</h3>
        <button (click)="nextMonth()" class="month-nav-btn text-black bg-white bg-opacity-20 hover:bg-opacity-30">
          ‚Ä∫
        </button>
      </div>
    </div>

    <div class="p-4">
      <!-- D√≠as de la semana -->
      <div class="calendar-grid mb-2">
        <div class="week-day">D</div>
        <div class="week-day">L</div>
        <div class="week-day">M</div>
        <div class="week-day">M</div>
        <div class="week-day">J</div>
        <div class="week-day">V</div>
        <div class="week-day">S</div>
      </div>

      <!-- D√≠as del calendario -->
      <div class="calendar-grid">
        <div *ngFor="let day of calendarDays" 
             [class]="getDayClass(day)"
             (click)="selectDate(day)"
             class="calendar-day">
          {{ day.date.getDate() }}
          <div *ngIf="hasEvent(day.date)" 
               [class]="'event-dot ' + getEventDotClass(day.date)"></div>
        </div>
      </div>

      <!-- Pr√≥ximo evento -->
      <div *ngIf="nextEvent" class="mt-6 p-4 bg-blue-50 rounded-lg">
        <h4 class="font-semibold text-blue-800 mb-2">Pr√≥ximo Evento</h4>
        <p class="text-sm text-blue-700">{{ nextEvent.title }}</p>
        <p class="text-xs text-blue-600">{{ nextEvent.date | date:'dd/MM/yyyy' }} - {{ nextEvent.time }}</p>
      </div>

      <!-- Eventos del d√≠a seleccionado -->
      <div class="mt-6 border-t pt-4">
        <h4 class="font-semibold text-gray-800 mb-3 text-sm">
          Eventos - {{ selectedDate ? (selectedDate | date:'dd/MM/yyyy') : 'Hoy' }}
        </h4>
        <div class="space-y-2 max-h-60 overflow-y-auto">
          <div *ngFor="let event of getDayEvents()" 
               [class]="'event-item ' + getEventItemClass(event)">
            <div class="font-medium text-sm">{{ event.title }}</div>
            <div class="text-xs opacity-75 mt-1">{{ event.time }}</div>
            <div *ngIf="event.description" class="text-xs mt-1 text-opacity-90">{{ event.description }}</div>
            <!-- üÜï BADGE DE TIPO DE EVENTO -->
            <div class="text-xs mt-1">
              <span [class]="event.eventType === 'tournament' ? 
                            'bg-purple-100 text-purple-800 px-2 py-1 rounded' : 
                            'bg-green-100 text-green-800 px-2 py-1 rounded'">
                {{ event.eventType === 'tournament' ? 'üèÜ Torneo' : 'üèãÔ∏è Entrenamiento' }}
              </span>
            </div>
          </div>
          <div *ngIf="getDayEvents().length === 0" class="text-gray-500 text-sm text-center py-4">
            No hay eventos para este d√≠a
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Chat Sidebar -->
<div [class]="'sidebar chat-sidebar ' + (chatVisible ? 'open' : '')">
  <div class="p-4 border-b bg-green-600 text-white">
    <div class="flex justify-between items-center">
      <div class="flex-1 text-center"> <!-- Contenedor para centrar -->
        <h2 class="text-lg font-bold">üí¨ Chat General</h2>
      </div>
      <button (click)="toggleChat()" class="calendar-close-btn bg-red-500 hover:bg-red-600">
        √ó
      </button>
    </div>
  </div>
  
  <!-- √Årea de mensajes -->
  <div class="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50">
    <!-- Mensaje cuando no hay mensajes -->
    <div *ngIf="chatMessages.length === 0" class="text-center text-gray-500 py-8">
      <div class="text-4xl mb-2">üí¨</div>
      <p class="font-medium">No hay mensajes a√∫n</p>
      <p class="text-sm mt-1">S√© el primero en enviar un mensaje</p>
    </div>

    <!-- Lista de mensajes -->
    <div *ngFor="let message of chatMessages" 
         class="flex"
         [class.justify-end]="isOwnMessage(message)" 
         [class.justify-start]="!isOwnMessage(message)">
      
      <!-- Mensaje de OTROS usuarios -->
      <div *ngIf="!isOwnMessage(message)" class="flex items-start space-x-3 max-w-xs">
        <!-- Avatar -->
        <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-semibold flex-shrink-0">
          {{ getAvatarInitials(message.sender) }}
        </div>
        <!-- Contenido del mensaje -->
        <div class="bg-white border border-gray-300 rounded-2xl p-4 shadow-sm">
          <!-- Informaci√≥n del remitente -->
          <div class="flex items-center space-x-2 mb-2">
            <span class="font-semibold text-sm text-gray-900">
              {{ message.sender.firstName }} {{ message.sender.lastName }}
            </span>
            <span class="text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded-full capitalize font-medium">
              {{ message.sender.role.toLowerCase() }}
            </span>
          </div>
          <!-- Texto del mensaje -->
          <div class="text-sm text-gray-800 break-words leading-relaxed">{{ message.content }}</div>
          <!-- Hora -->
          <div class="text-xs text-gray-500 mt-2">{{ formatMessageTime(message.createdAt) }}</div>
        </div>
      </div>
      
      <!-- Mensaje PROPIO (Jugador) -->
      <div *ngIf="isOwnMessage(message)" class="flex flex-col items-end max-w-xs">
        <!-- Informaci√≥n del remitente (t√∫) -->
        <div class="flex items-center space-x-2 mb-1 px-2">
          <span class="text-xs text-gray-600 font-medium">T√∫</span>
          <span class="text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full capitalize font-medium">
            {{ currentUser?.role?.toLowerCase() }}
          </span>
        </div>
        <!-- Contenido del mensaje -->
        <div class="bg-green-600 text-white rounded-2xl p-4 shadow-sm">
          <!-- Texto del mensaje -->
          <div class="text-sm break-words leading-relaxed">{{ message.content }}</div>
          <!-- Hora y estado -->
          <div class="text-xs text-green-200 mt-2 flex justify-between items-center">
            <span>{{ formatMessageTime(message.createdAt) }}</span>
            <span class="text-xs ml-2">‚úì‚úì</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- √Årea de escritura -->
  <div class="p-4 border-t bg-white border-gray-200">
    <div class="flex flex-col space-y-3">
      <!-- Input de texto -->
      <div class="relative">
        <input 
          type="text" 
          [(ngModel)]="newMessage"
          (keydown.enter)="sendMessage()"
          placeholder="Escribe tu mensaje aqu√≠..." 
          class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition duration-200 text-gray-900 bg-white text-base placeholder-gray-500"
          [class.border-red-400]="!newMessage.trim()">
        
        <!-- Indicador de texto visible -->
        <div *ngIf="newMessage" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-xs text-gray-500 bg-white px-1">
          {{ newMessage.length }}/500
        </div>
      </div>
      
      <!-- Bot√≥n enviar -->
      <button 
        (click)="sendMessage()" 
        [disabled]="!newMessage.trim()"
        class="w-full bg-green-600 text-white py-3 rounded-xl hover:bg-green-700 transition duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed font-semibold text-base">
        Enviar Mensaje
      </button>
    </div>
    
    <p class="text-xs text-gray-500 mt-3 text-center">
      üí° Presiona Enter para enviar r√°pidamente
    </p>
  </div>
</div>